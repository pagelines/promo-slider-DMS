<?php/*Plugin Name: Promo SliderDescription: Promo Slider adds a button on right or left of the page that slides out to reveal a promo when you click on it! It is a vertical element that shows on the left or right hand side of your site!Version: 2.0Author: Catapult ImpactAuthor URI: http://www.catapultimpact.comDemo: http://catapultimpact.com/pagelines/promo-slider/Pagelines: true*/class PageLinesPromoSlider{	function __construct() {		$this->base_url = sprintf( '%s/%s', WP_PLUGIN_URL,  basename(dirname( __FILE__ )));		$this->icon = $this->base_url . '/icon.png';		$this->base_dir = sprintf( '%s/%s', WP_PLUGIN_DIR,  basename(dirname( __FILE__ )));		$this->base_file = sprintf( '%s/%s/%s', WP_PLUGIN_DIR,  basename(dirname( __FILE__ )), basename( __FILE__ ));		// register plugin hooks...				$this->plugin_hooks();	}				function plugin_hooks(){		// Always run				add_action( 'after_setup_theme', array( &$this, 'options' ));				add_action( 'wp_enqueue_scripts', array( &$this, 'promo_css' ) );			add_action( 'pagelines_page', array( &$this, 'promo_slider' ));	}		function promo_css() {		wp_register_style( 'promo-style', plugins_url( 'maincss.css', __FILE__ ) );		wp_enqueue_style( 'promo-style' );	}	//function to change hexadecimal value of color to rgb value	function hex2rgb( $colour ){        		if( $colour[0] == '#' ){						$colour = substr( $colour, 1 );        		}        		if( strlen( $colour ) == 6 ){						list( $r, $g, $b ) = array( $colour[0] . $colour[1], $colour[2] . $colour[3], $colour[4] . $colour[5] );        		}elseif( strlen( $colour ) == 3 ){						list( $r, $g, $b ) = array( $colour[0] . $colour[0], $colour[1] . $colour[1], $colour[2] . $colour[2] );        		}else{						return false;        		}        		$r = hexdec( $r );        		$g = hexdec( $g );        		$b = hexdec( $b );        		return array( 'red' => $r, 'green' => $g, 'blue' => $b );		}	function promo_slider(){		$show_promo_slider = pl_setting('show_promoslider');		if( $show_promo_slider ){			$slider_buttontitle = pl_setting('promoslider_title');						$slider_buttontitle_color = (pl_setting('promoslider_title_color')!='') ? pl_hash( pl_setting('promoslider_title_color') ) : '';						$slider_title_bkcolor = (pl_setting('promoslider_title_bkcolor')!='') ? pl_hash( pl_setting('promoslider_title_bkcolor') ) : '';						if( $slider_title_bkcolor != '' ){						$slider_title_bkcolor_arr = array();							// convert hexadecimal value of color to rgb value				$slider_title_bkcolor_arr = $this->hex2rgb( $slider_title_bkcolor );							}						$slider_title_bkgrnd_op_th = (pl_setting('promoslider_title_bkopacity')!='') ? rtrim( pl_setting('promoslider_title_bkopacity'),'%' ) : 100;					$slider_title_bkgrnd_op = ( $slider_title_bkgrnd_op_th / 100 );			$slider_buttonorentation = strtolower(pl_setting('promoslider_orientation'));			$slider_buttonposition = pl_setting('promoslider_top_position');			$slider_contentbox = stripslashes(pl_setting('promoslider_content'));						$slider_content_color = (pl_setting('promoslider_content_color')!='') ? pl_hash( pl_setting('promoslider_content_color') ) : '';						$slider_hide_mob = (pl_setting('promoslider_hide_mob')!='') ? pl_setting('promoslider_hide_mob') : 2;						if($slider_buttonorentation == "left"){				$sliderdivname = "QuickContentSlider-left";				$buttondivname = "QuickContentSlider-button-left";				$contentdivname = "QuickContentSlider-content-left";				$button_position = $slider_buttonposition;				$sliderbuttonbutton ='					<script>						var $j = jQuery.noConflict();						$j(window).load(function(){							if($j.browser.msie && $j.browser.version <= 8.0){								$j(".'.$buttondivname.'").addClass("QuickContentSlider-button-left-ie");								var content_width = $j(".'.$contentdivname.'").outerWidth(); 								var button_height = $j(".'.$buttondivname.'").outerHeight();								var button_inner_height = $j(".'.$buttondivname.'").height();								var content_height = $j(".'.$contentdivname.'").outerHeight(); 								var content_inner_height = $j(".'.$contentdivname.'").height(); 								$j("#'.$sliderdivname.'").css({"left":"-"+content_width+"px","top":"'.$button_position.'"});								$j("#'.$sliderdivname.'").css("z-index", "1035");								if(button_height > content_height){									var button_left = $j(".'.$buttondivname.'").outerHeight();									$j(".'.$buttondivname.'").css("right","-"+button_left+"px");												var paddint_top = parseInt($j(".'.$contentdivname.'").css("padding-top"), 10);									var paddint_bottom = parseInt($j(".'.$contentdivname.'").css("padding-bottom"), 10);									var new_content_height = button_height - (paddint_top + paddint_bottom);									$j(".'.$contentdivname.'").css("height",new_content_height+"px");								}else{									var paddint_top = parseInt($j(".'.$buttondivname.'").css("padding-top"), 10);									var paddint_bottom = parseInt($j(".'.$buttondivname.'").css("padding-bottom"), 10);									var button_update_height = content_height - (paddint_top + paddint_bottom);									$j(".'.$buttondivname.'").css("width",button_update_height+"px");									var button_left = $j(".'.$buttondivname.'").outerHeight();									$j(".'.$buttondivname.'").css("right","-"+button_left+"px");								}							}else{								var content_width = $j(".'.$contentdivname.'").outerWidth(); 								var button_height = $j(".'.$buttondivname.'").outerWidth();								var button_inner_height = $j(".'.$buttondivname.'").width();								var content_height = $j(".'.$contentdivname.'").outerHeight(); 								var content_inner_height = $j(".'.$contentdivname.'").height();								$j("#'.$sliderdivname.'").css({"left":"-"+content_width+"px","top":"'.$button_position.'"});								$j("#'.$sliderdivname.'").css("z-index", "1035");								if(button_height > content_height){									var new_but_top = button_inner_height - 21;									$j(".'.$buttondivname.'").css("right","0px");									var paddint_top = parseInt($j(".'.$contentdivname.'").css("padding-top"), 10);									var paddint_bottom = parseInt($j(".'.$contentdivname.'").css("padding-bottom"), 10);									var new_content_height = button_height - (paddint_top + paddint_bottom);									$j(".'.$contentdivname.'").css("height",new_content_height+"px");									$j(".'.$buttondivname.'").css("top",new_but_top+"px");								}else{									var paddint_top = parseInt($j(".'.$buttondivname.'").css("padding-top"), 10);									var paddint_bottom = parseInt($j(".'.$buttondivname.'").css("padding-bottom"), 10);									var button_update_height = content_height - (paddint_top + paddint_bottom);									$j(".'.$buttondivname.'").css("width",button_update_height+"px");									$j(".'.$buttondivname.'").css("right","0px");									var new_cont_top = button_update_height - 21;									$j(".'.$buttondivname.'").css("top",new_cont_top+"px");								}							}							$j(".'.$buttondivname.'").click(function(){								$j("#'.$sliderdivname.'").animate({"left":"0px"},1000);							});														$j(".'.$contentdivname.'").hover("",function(){									$j("#'.$sliderdivname.'").stop().delay(500).animate({"left":"-"+content_width+"px"},1000);							});							$j(".'.$contentdivname.'").css("visibility","visible");							$j(".'.$buttondivname.'").css("visibility","visible");						});					</script>				';			}elseif($slider_buttonorentation == "right"){				$sliderdivname = "QuickContentSlider-right";				$buttondivname = "QuickContentSlider-button-right";				$contentdivname = "QuickContentSlider-content-right";				$button_position = $slider_buttonposition;				$sliderbuttonbutton ='					<script>						var $j = jQuery.noConflict();						$j(window).load(function(){							if($j.browser.msie && $j.browser.version <= 8.0){								$j(".'.$buttondivname.'").addClass("QuickContentSlider-button-right-ie");								var content_width = $j(".'.$contentdivname.'").outerWidth(); 								var button_height = $j(".'.$buttondivname.'").outerHeight();								var button_inner_height = $j(".'.$buttondivname.'").height();								var content_height = $j(".'.$contentdivname.'").outerHeight(); 								var content_inner_height = $j(".'.$contentdivname.'").height(); 								$j("#'.$sliderdivname.'").css({"right":"-"+content_width+"px","top":"'.$button_position.'"});								$j("#'.$sliderdivname.'").css("z-index", "1035");								if(button_height > content_height){									var button_left = $j(".'.$buttondivname.'").outerWidth();									$j(".'.$buttondivname.'").css("left","-"+button_left+"px");												var paddint_top = parseInt($j(".'.$contentdivname.'").css("padding-top"), 10);									var paddint_bottom = parseInt($j(".'.$contentdivname.'").css("padding-bottom"), 10);									var new_content_height = button_height - (paddint_top + paddint_bottom);									$j(".'.$contentdivname.'").css("height",new_content_height+"px");								}else{									var button_update_height = content_height - 24;									$j(".'.$buttondivname.'").css("width",button_update_height+"px");									var button_left = $j(".'.$buttondivname.'").outerWidth();									$j(".'.$buttondivname.'").css("left","-"+button_left+"px");								}							}else{								var content_width = $j(".'.$contentdivname.'").outerWidth(); 								var button_height = $j(".'.$buttondivname.'").outerWidth();								var button_inner_height = $j(".'.$buttondivname.'").width();								var content_height = $j(".'.$contentdivname.'").outerHeight(); 								var content_inner_height = $j(".'.$contentdivname.'").height(); 								$j("#'.$sliderdivname.'").css({"right":"-"+content_width+"px","top":"'.$button_position.'"});								$j("#'.$sliderdivname.'").css("z-index", "1035");								if(button_height > content_height){									$j(".'.$buttondivname.'").css("left","-"+button_height+"px");												var paddint_top = parseInt($j(".'.$contentdivname.'").css("padding-top"), 10);									var paddint_bottom = parseInt($j(".'.$contentdivname.'").css("padding-bottom"), 10);									var new_content_height = button_height - (paddint_top + paddint_bottom);									$j(".'.$contentdivname.'").css("height",new_content_height+"px");								}else{									var button_update_height = content_height - 24;									$j(".'.$buttondivname.'").css("width",button_update_height+"px");									$j(".'.$buttondivname.'").css("left","-"+content_height+"px");								}							}														$j(".'.$buttondivname.'").click(function(){								$j("#'.$sliderdivname.'").animate({right:0},1000);							});														$j(".'.$contentdivname.'").hover("",function(){									$j("#'.$sliderdivname.'").stop().animate({right:-content_width},1000);							});							$j(".'.$contentdivname.'").css("visibility","visible");							$j(".'.$buttondivname.'").css("visibility","visible");						});					</script>				';			}						if( $slider_hide_mob == 1 ){									$slider_hide_mob_str .=	'<style>																	body.mobile #'.$sliderdivname.'{																			display: none !important;																		}																</style>';								echo $slider_hide_mob_str;										}						$slider_buttontitle_color_str = '';						if( $slider_buttontitle_color != '' ){							$slider_buttontitle_color_str = 'color: '.$slider_buttontitle_color.';';							}						$slider_title_bkcolor_str = '';						if( $slider_title_bkcolor != '' ){							$slider_title_bkcolor_str = 'background-color: rgba('.$slider_title_bkcolor_arr['red'].', '.$slider_title_bkcolor_arr['green'].', '.$slider_title_bkcolor_arr['blue'].', '.$slider_title_bkgrnd_op.');';						}			$slider_content_color_str = '';						if( $slider_content_color != '' ){							$slider_content_color_str = 'color: '.$slider_content_color.';';						}						$sliderbuttonbutton .= '<div id="'.$sliderdivname.'">										<div style="'.$slider_buttontitle_color_str.$slider_title_bkcolor_str.'" class="'.$buttondivname.'">'.$slider_buttontitle.'</div>										<div style="'.$slider_content_color_str.'" class="'.$contentdivname.'">'.wpautop(do_shortcode("$slider_contentbox")).'</div>									</div>';			echo $sliderbuttonbutton;		}	}		function options(){				if( !function_exists('pl_setting') )						return;							$options = array();		$options[] = array(			'key'		=> 'promoslider_show_settings',			'type'		=> 'multi',						'title'		=> __('Promo Slider Main Options', 'pagelines'),						'col'		=> 1,						'opts'	=> array(				array(					'key'	=> 'show_promoslider',										'type' 	=> 'check',										'label' => 'Activate the Promo Slider globally?',										'help'	=> 'This option will activate the Promo Slider globally.'				),				array(					'key'	=> 'promoslider_orientation',					'type' 	=> 'select',					'label' => 'Select Promo Slider Orientation',					'opts'	=> array(						'right'	=> array('name'	=>'Right (Default)'),						'left'			=> array('name'	=>'Left'),					),				),				array(					'key'	  => 'promoslider_top_position',					'type'    => 'text',					'label'	  => 'Promo Slider top position.'				),				array(					'key'	=> 'promoslider_hide_mob',					'type' 	=> 'check',					'label' => 'Hide Promo Slider on Mobile Devices?'				),			),		);				$options[] = array(			'key'		=> 'promoslider_setup',			'type'		=> 'multi',			'col'		=> 2,			'title'		=> 'Promo Slider Title',			'opts'	=> array(				array(					'key'		=> 'promoslider_title',					'type' 		=> 'text',					'label'		=> 'Promo Slider Title'				),				array(					'key'		=> 'promoslider_title_color',					'type' 		=> 'color',					'label'		=> 'Promo Slider Title Color'				),								array(					'key'		=> 'promoslider_title_bkcolor',					'type' 		=> 'color',					'label' 	=> 'Promo Slider Title Background Color'				),				array(					'key'		=> 'promoslider_title_bkopacity',					'type' 		=> 'text',					'label' 	=> 'Promo Slider Title Background Opacity',										'help'		=> 'Leave blank if you dont want background, or set value in percentage (e.g 70%)'				),				array(					'key'		=> 'promoslider_content',					'type' 		=> 'textarea',					'label' 	=> 'Promo Slider Content'				),								array(					'key'		=> 'promoslider_content_color',					'type' 		=> 'color',					'label' 	=> 'Promo Slider Content Text Color'				),							),		);				$option_args = array(			'name'		=> 'Promo Slider',						'opts'		=> $options,						'icon'		=> 'icon-tag',						'pos'		=> 12				);				pl_add_options_page( $option_args );	}	}new PageLinesPromoSlider;?>